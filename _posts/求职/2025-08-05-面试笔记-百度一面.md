---
layout: post
title:  "面试复盘之百度"
date:   2025-08-05 22:47:14 +0800
categories: 工作 求职
---
## 面试复盘之百度

#### 算法：

* LeetCode 139：单词拆分
* LeetCode 20：有效的括号


### 1、数据库产品的数据一致性测试方法

数据一致性是数据库的核心要求，测试方法需覆盖多种场景：

#### 1. **事务一致性测试**

* **ACID 验证**
  通过并发操作测试原子性（Atomicity）和隔离性（Isolation）。例如：模拟转账中途故障，验证是否回滚。
* **隔离级别测试**
  在不同隔离级别（如 Read Committed、Serializable）下，检查脏读、幻读等问题。

#### 2. **主从同步一致性**

* **延迟写入检测**
  在主库写入后，立即在从库查询，验证同步延迟和数据准确性。
* **断网恢复测试**
  模拟网络中断后恢复，检查从库是否自动追补数据且无冲突。

#### 3. **分布式数据库场景**

* **多副本一致性**
  使用 Raft/Paxos 的数据库，可主动停掉节点，观察数据是否最终一致。
* **冲突解决机制**
  模拟两地同时修改同条数据，测试冲突合并策略（如 LWW、CRDTs）。

#### 4. **逻辑一致性校验**

* **checksum 工具**
  如 MySQL 的 `pt-table-checksum`，对比主从库数据哈希值。
* **业务规则检查**
  例如：账户余额禁止为负，通过脚本批量验证数据约束。

#### 5. **故障注入测试**

* 强制宕机、磁盘损坏等异常，恢复后检查数据是否符合预期状态。

---

### 2、什么是流复制（Streaming Replication）

#### 核心概念

流复制是一种**实时异步传输数据库变更**的技术，主库将事务日志（WAL）分段发送给从库，从库重放日志实现数据同步。常见于 PostgreSQL、MySQL 等。

#### 工作流程

1. **主库**
   事务提交时生成 WAL 日志，通过 TCP 流式传输给从库。
2. **从库**
   接收 WAL 日志并写入本地缓存，由独立进程重放日志更新数据。
3. **同步模式**
   * **异步模式** ：主库提交后无需等待从库确认（高性能，默认方式）。
   * **同步模式** ：主库需至少一个从库确认才返回成功（强一致，影响性能）。

#### 关键优势

* **低延迟同步** ：秒级数据延迟（对比传统备份）。
* **高可用基础** ：支持快速故障切换（如 PostgreSQL 的 Patroni）。
* **读写分离** ：从库处理查询，分担主库负载。

#### 典型应用

* PostgreSQL：原生支持流复制，是物理复制的核心。
* MySQL：类似技术为 Binlog Replication（逻辑复制）。

### 总结关联

流复制是实现**主从数据一致性**的关键技术，而一致性测试需验证流复制在断网、高负载等场景下是否仍能保障数据正确。例如：测试主库宕机后，从库提升为主时数据是否零丢失
